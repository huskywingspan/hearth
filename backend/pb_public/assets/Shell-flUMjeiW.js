import{r as o,j as e,N as u,p as a}from"./index-BDy1BAFk.js";function x(){const[t,s]=o.useState([]);return o.useEffect(()=>{async function n(){try{const r=a.authStore.record?.id;if(!r)return;const l=(await a.collection("room_members").getFullList({filter:`user = "${r}"`,expand:"room"})).map(c=>c.expand?.room).filter(c=>!!c);s(l)}catch{}}n()},[]),e.jsxs("nav",{className:"flex flex-col h-full bg-[var(--color-bg-secondary)]",children:[e.jsx("div",{className:"px-4 py-5",children:e.jsx("h1",{className:"font-display text-xl text-[var(--color-accent-amber)]",children:"Hearth"})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-2 space-y-1",children:t.length===0?e.jsx("p",{className:"px-3 py-2 text-sm text-[var(--color-text-muted)]",children:"No rooms yet"}):t.map(n=>e.jsx(u,{to:`/room/${n.id}`,className:({isActive:r})=>["block px-3 py-2 rounded-[var(--radius-md)] text-sm","transition-colors duration-[var(--duration-fast)]",r?"bg-[var(--color-bg-elevated)] text-[var(--color-accent-amber)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-primary)] hover:text-[var(--color-text-primary)]"].join(" "),children:n.name},n.id))}),e.jsx("div",{className:"p-4 border-t border-[var(--color-bg-elevated)]",children:e.jsx("button",{onClick:()=>a.authStore.clear(),className:"text-xs text-[var(--color-text-muted)] hover:text-[var(--color-alert-clay)] transition-colors duration-[var(--duration-fast)]",children:"Sign out"})})]})}function p(t){const s=o.useRef(!0);o.useEffect(()=>{const n=a.realtime.subscribe("PB_CONNECT",async()=>{if(s.current){s.current=!1;return}try{await a.collection("users").authRefresh()}catch{a.authStore.clear();return}t()});return()=>{n.then(r=>r())}},[t])}function d(){const[t,s]=o.useState(!0),[n,r]=o.useState(!1);o.useEffect(()=>{a.realtime.onDisconnect=()=>{s(!1),r(!0)};const l=a.realtime.subscribe("PB_CONNECT",()=>{s(!0),r(!1)});return()=>{l.then(c=>c())}},[]);const i=o.useCallback(()=>{r(!0)},[]);return{isConnected:t,isReconnecting:n,forceResync:i}}function m(){const{isConnected:t,isReconnecting:s}=d();return t?null:e.jsx("div",{className:"fixed top-0 inset-x-0 bg-[var(--color-alert-clay)] text-[var(--color-text-primary)] text-center py-1.5 text-sm animate-float-in z-50",children:s?"Reconnecting...":"Offline"})}function v({children:t}){return e.jsxs(e.Fragment,{children:[e.jsx(m,{}),e.jsxs("div",{className:"flex h-screen bg-[var(--color-bg-primary)]",children:[e.jsx("aside",{className:"hidden md:flex md:w-64 lg:w-72 flex-col shrink-0",children:e.jsx(x,{})}),e.jsx("main",{className:"flex-1 flex flex-col min-w-0",children:t})]})]})}export{v as S,p as u};
//# sourceMappingURL=Shell-flUMjeiW.js.map
